<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BPO Leader: Time Management Challenge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
            overflow: hidden;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .stat {
            text-align: center;
            flex: 1;
        }

        .stat-icon {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #495057;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            transition: width 0.3s ease;
        }

        .morale-fill { background: linear-gradient(90deg, #28a745, #20c997); }
        .time-fill { background: linear-gradient(90deg, #ffc107, #fd7e14); }
        .wellness-fill { background: linear-gradient(90deg, #6f42c1, #e83e8c); }
        .project-fill { background: linear-gradient(90deg, #007bff, #17a2b8); }

        .scene-container {
            padding: 30px;
            min-height: 400px;
        }

        .scene-image {
            text-align: center;
            font-size: 5em;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .scene-title {
            font-size: 1.8em;
            color: #495057;
            margin-bottom: 15px;
            text-align: center;
        }

        .scene-description {
            font-size: 1.1em;
            line-height: 1.6;
            color: #6c757d;
            margin-bottom: 30px;
            text-align: center;
        }

        .character-dialogue {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .character-name {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }

        .choice-btn {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .choice-btn:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .choice-btn::before {
            content: '‚Üí';
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
        }

        .ending-summary {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
        }

        .ending-grade {
            text-align: center;
            font-size: 4em;
            margin: 20px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .feedback-section {
            margin: 20px 0;
        }

        .feedback-title {
            font-size: 1.3em;
            color: #495057;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feedback-list {
            list-style: none;
            padding-left: 20px;
        }

        .feedback-list li {
            margin: 10px 0;
            color: #6c757d;
        }

        .feedback-list li::before {
            content: '‚úì ';
            color: #28a745;
            font-weight: bold;
            margin-right: 5px;
        }

        .feedback-list.improvements li::before {
            content: '‚Ä¢ ';
            color: #ffc107;
        }

        .restart-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.1em;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .restart-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            animation: slideInRight 0.3s ease;
            max-width: 300px;
            z-index: 1000;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.show {
            display: block;
        }

        .notification.positive {
            border-left: 4px solid #28a745;
        }

        .notification.negative {
            border-left: 4px solid #dc3545;
        }

        .notification.neutral {
            border-left: 4px solid #ffc107;
        }

        @media (max-width: 600px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .stats-bar {
                flex-wrap: wrap;
            }
            
            .stat {
                flex: 1 1 45%;
                margin-bottom: 10px;
            }

            .notification {
                right: 10px;
                left: 10px;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>üéØ BPO Leader Challenge</h1>
            <div class="subtitle">Master the Art of Time Management</div>
        </div>

        <div class="stats-bar">
            <div class="stat">
                <div class="stat-icon">üòä</div>
                <div class="stat-label">Team Morale</div>
                <div class="stat-value"><span id="morale">75</span>%</div>
                <div class="progress-bar">
                    <div class="progress-fill morale-fill" id="morale-bar" style="width: 75%"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-icon">‚è∞</div>
                <div class="stat-label">Time Left</div>
                <div class="stat-value"><span id="time">40</span> hrs</div>
                <div class="progress-bar">
                    <div class="progress-fill time-fill" id="time-bar" style="width: 100%"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-icon">üßò</div>
                <div class="stat-label">Wellness</div>
                <div class="stat-value"><span id="wellness">70</span>%</div>
                <div class="progress-bar">
                    <div class="progress-fill wellness-fill" id="wellness-bar" style="width: 70%"></div>
                </div>
            </div>
            <div class="stat">
                <div class="stat-icon">üìä</div>
                <div class="stat-label">Projects</div>
                <div class="stat-value"><span id="project">0</span>%</div>
                <div class="progress-bar">
                    <div class="progress-fill project-fill" id="project-bar" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div class="scene-container" id="scene-container">
            <!-- Game content will be dynamically inserted here -->
        </div>
    </div>

    <div class="notification" id="notification">
        <div id="notification-text"></div>
    </div>

    <script>
        // Game State
        const gameState = {
            currentScene: 'intro',
            stats: {
                morale: 75,
                timeLeft: 40,
                wellness: 70,
                projectCompletion: 0
            },
            maxTime: 40,
            decisions: [],
            characters: {
                boss: { name: 'Director Martinez', emoji: 'üëî' },
                mentor: { name: 'Sarah Chen', emoji: 'üßô‚Äç‚ôÄÔ∏è' },
                employee1: { name: 'Alex Thompson', emoji: 'üë®‚Äçüíª', morale: 70 },
                employee2: { name: 'Maya Patel', emoji: 'üë©‚Äçüíº', morale: 75 },
                employee3: { name: 'James Wilson', emoji: 'üßë‚Äçüíª', morale: 65 }
            }
        };

        // Scenes Database
        const scenes = {
            intro: {
                title: "Welcome to Your First Week as Team Lead!",
                image: "üè¢",
                description: "You've just been promoted to Team Lead at GlobalTech BPO. Your team handles customer service for multiple international clients. It's Monday morning, and you have a challenging week ahead with a major project deadline on Friday.",
                dialogue: {
                    character: 'mentor',
                    text: "Congratulations on your promotion! Remember, effective leadership is about balancing team needs, project demands, and your own well-being. Make wise choices!"
                },
                choices: [
                    {
                        text: "Start with a team meeting to set expectations",
                        next: 'teamMeeting',
                        effects: { timeLeft: -2, morale: 5, wellness: 0, projectCompletion: 10 }
                    },
                    {
                        text: "Jump straight into work to maximize productivity",
                        next: 'straightToWork',
                        effects: { timeLeft: -1, morale: -5, wellness: -5, projectCompletion: 15 }
                    },
                    {
                        text: "Review emails and plan your week first",
                        next: 'planning',
                        effects: { timeLeft: -1, morale: 0, wellness: 5, projectCompletion: 5 }
                    }
                ]
            },

            teamMeeting: {
                title: "Team Meeting in Progress",
                image: "üë•",
                description: "You've gathered your team for a morning meeting. The atmosphere is positive, and everyone seems engaged.",
                dialogue: {
                    character: 'employee1',
                    text: "Thanks for bringing us together! I have some concerns about the project timeline, but I'm ready to give my best."
                },
                choices: [
                    {
                        text: "Address concerns and create a detailed task distribution",
                        next: 'crisisCall',
                        effects: { timeLeft: -3, morale: 10, wellness: 0, projectCompletion: 15 }
                    },
                    {
                        text: "Keep it brief and assign tasks quickly",
                        next: 'crisisCall',
                        effects: { timeLeft: -1, morale: 3, wellness: 0, projectCompletion: 10 }
                    },
                    {
                        text: "Turn it into a brainstorming session",
                        next: 'crisisCall',
                        effects: { timeLeft: -2, morale: 7, wellness: -3, projectCompletion: 8 }
                    }
                ]
            },

            straightToWork: {
                title: "Diving Into the Deep End",
                image: "üíª",
                description: "You've jumped straight into work. Your team seems confused about priorities, but work is getting done.",
                dialogue: {
                    character: 'employee2',
                    text: "I'm not sure what to prioritize. Should I focus on the urgent tickets or the project deliverables?"
                },
                choices: [
                    {
                        text: "Take time to clarify priorities now",
                        next: 'crisisCall',
                        effects: { timeLeft: -2, morale: 8, wellness: 0, projectCompletion: 12 }
                    },
                    {
                        text: "Tell them to focus on the project only",
                        next: 'crisisCall',
                        effects: { timeLeft: -1, morale: -3, wellness: -5, projectCompletion: 18 }
                    },
                    {
                        text: "Let them decide based on their judgment",
                        next: 'crisisCall',
                        effects: { timeLeft: 0, morale: 2, wellness: 3, projectCompletion: 8 }
                    }
                ]
            },

            planning: {
                title: "Strategic Planning Session",
                image: "üìã",
                description: "You're reviewing the week's requirements. You notice several conflicting priorities and tight deadlines.",
                dialogue: {
                    character: 'boss',
                    text: "I see you're taking a strategic approach. Good! Remember, the client presentation on Friday is critical."
                },
                choices: [
                    {
                        text: "Create a detailed project plan and share with team",
                        next: 'crisisCall',
                        effects: { timeLeft: -2, morale: 5, wellness: 5, projectCompletion: 20 }
                    },
                    {
                        text: "Delegate planning to senior team members",
                        next: 'crisisCall',
                        effects: { timeLeft: -1, morale: 3, wellness: 8, projectCompletion: 12 }
                    },
                    {
                        text: "Focus only on the critical Friday deadline",
                        next: 'crisisCall',
                        effects: { timeLeft: -1, morale: -2, wellness: -3, projectCompletion: 15 }
                    }
                ]
            },

            crisisCall: {
                title: "Urgent Client Escalation!",
                image: "üìû",
                description: "Tuesday morning: A major client is furious about service delays. They're threatening to cancel their contract. Your boss wants immediate action.",
                dialogue: {
                    character: 'boss',
                    text: "We have a crisis! The client wants answers NOW. This could affect our entire quarter. What's your plan?"
                },
                choices: [
                    {
                        text: "Drop everything and handle it personally",
                        next: 'midweekCheck',
                        effects: { timeLeft: -5, morale: -10, wellness: -15, projectCompletion: -5 }
                    },
                    {
                        text: "Delegate to your best performer while you supervise",
                        next: 'midweekCheck',
                        effects: { timeLeft: -3, morale: -5, wellness: -5, projectCompletion: 5 }
                    },
                    {
                        text: "Form a crisis team and rotate responsibilities",
                        next: 'midweekCheck',
                        effects: { timeLeft: -3, morale: 5, wellness: 0, projectCompletion: 3 }
                    },
                    {
                        text: "Set boundaries: Schedule a call within 2 hours after prep",
                        next: 'midweekCheck',
                        effects: { timeLeft: -2, morale: 3, wellness: 10, projectCompletion: 2 }
                    }
                ]
            },

            midweekCheck: {
                title: "Wednesday: Mid-Week Reality Check",
                image: "üìä",
                description: "It's Wednesday afternoon. The project is behind schedule, and your team is showing signs of stress. Two team members have requested time off for personal matters.",
                dialogue: {
                    character: 'employee3',
                    text: "Boss, I hate to ask, but I really need Friday afternoon off for a family emergency. I know the deadline is tight..."
                },
                choices: [
                    {
                        text: "Deny all time off until after the deadline",
                        next: 'overtimeDecision',
                        effects: { timeLeft: 0, morale: -20, wellness: -10, projectCompletion: 10 }
                    },
                    {
                        text: "Approve requests but ask for overtime from others",
                        next: 'overtimeDecision',
                        effects: { timeLeft: -2, morale: 5, wellness: -10, projectCompletion: 5 }
                    },
                    {
                        text: "Approve one request, work with team to cover",
                        next: 'overtimeDecision',
                        effects: { timeLeft: -3, morale: 10, wellness: 5, projectCompletion: 8 }
                    },
                    {
                        text: "Call your mentor for advice first",
                        next: 'mentorAdvice',
                        effects: { timeLeft: -1, morale: 3, wellness: 8, projectCompletion: 5 }
                    }
                ]
            },

            mentorAdvice: {
                title: "Wisdom from Your Mentor",
                image: "üßô‚Äç‚ôÄÔ∏è",
                description: "You've reached out to Sarah, your mentor, for guidance on balancing team needs with project demands.",
                dialogue: {
                    character: 'mentor',
                    text: "Remember, burning out your team for one deadline will cost you in the long run. But you also need to deliver. Consider what's truly critical versus what's perfectionism. What really needs to be in the Friday presentation?"
                },
                choices: [
                    {
                        text: "Reduce project scope to essentials only",
                        next: 'overtimeDecision',
                        effects: { timeLeft: -2, morale: 15, wellness: 10, projectCompletion: 15 }
                    },
                    {
                        text: "Keep full scope but redistribute work smartly",
                        next: 'overtimeDecision',
                        effects: { timeLeft: -3, morale: 5, wellness: 0, projectCompletion: 10 }
                    },
                    {
                        text: "Request deadline extension from your boss",
                        next: 'extensionRequest',
                        effects: { timeLeft: -1, morale: 8, wellness: 15, projectCompletion: -10 }
                    }
                ]
            },

            extensionRequest: {
                title: "Negotiating with Leadership",
                image: "ü§ù",
                description: "You're in your boss's office, requesting a deadline extension. The atmosphere is tense.",
                dialogue: {
                    character: 'boss',
                    text: "An extension? This is a critical client! But... I appreciate you coming to me early rather than failing at the last minute. If you can guarantee exceptional quality with 2 extra days, I might consider it."
                },
                choices: [
                    {
                        text: "Accept the 2-day extension and commit to excellence",
                        next: 'finalPush',
                        effects: { timeLeft: 0, morale: 20, wellness: 20, projectCompletion: 25 }
                    },
                    {
                        text: "Decline and push through with original deadline",
                        next: 'overtimeDecision',
                        effects: { timeLeft: 0, morale: -5, wellness: -10, projectCompletion: 15 }
                    }
                ]
            },

            overtimeDecision: {
                title: "Thursday: The Overtime Dilemma",
                image: "üåô",
                description: "It's Thursday evening. The project needs more work, and you're considering asking the team to stay late or work from home tonight.",
                dialogue: {
                    character: 'employee1',
                    text: "I can stay if needed, but I've already worked late twice this week. My family is starting to complain..."
                },
                choices: [
                    {
                        text: "Mandatory overtime for everyone",
                        next: 'finalPush',
                        effects: { timeLeft: -8, morale: -25, wellness: -20, projectCompletion: 30 }
                    },
                    {
                        text: "Make overtime voluntary with incentives",
                        next: 'finalPush',
                        effects: { timeLeft: -6, morale: 5, wellness: -5, projectCompletion: 20 }
                    },
                    {
                        text: "Work late yourself to cover the gap",
                        next: 'finalPush',
                        effects: { timeLeft: -10, morale: 10, wellness: -30, projectCompletion: 15 }
                    },
                    {
                        text: "Optimize what you have and avoid overtime",
                        next: 'finalPush',
                        effects: { timeLeft: -2, morale: 15, wellness: 15, projectCompletion: 10 }
                    }
                ]
            },

            finalPush: {
                title: "Friday: The Final Push",
                image: "üèÅ",
                description: "It's Friday morning. The presentation is at 3 PM. Your team is gathered, ready for the final push. The atmosphere is tense but determined.",
                dialogue: {
                    character: 'employee2',
                    text: "We're almost there! Just need to finalize the presentation deck and run through the demo one more time. How do you want to handle this?"
                },
                choices: [
                    {
                        text: "All hands on deck - everyone contributes",
                        next: 'presentation',
                        effects: { timeLeft: -4, morale: 10, wellness: 0, projectCompletion: 20 }
                    },
                    {
                        text: "Assign specific roles and trust your team",
                        next: 'presentation',
                        effects: { timeLeft: -3, morale: 15, wellness: 10, projectCompletion: 18 }
                    },
                    {
                        text: "Take control and perfect everything yourself",
                        next: 'presentation',
                        effects: { timeLeft: -6, morale: -10, wellness: -15, projectCompletion: 15 }
                    },
                    {
                        text: "Do a quick review and call it done",
                        next: 'presentation',
                        effects: { timeLeft: -1, morale: 5, wellness: 5, projectCompletion: 8 }
                    }
                ]
            },

            presentation: {
                title: "The Big Presentation",
                image: "üéØ",
                description: "You're in the conference room with the client on video call. Your team is behind you, and your boss is watching from the corner. This is your moment.",
                dialogue: {
                    character: 'boss',
                    text: "The client is ready. Show them what your team has accomplished this week."
                },
                choices: [
                    {
                        text: "Lead the presentation yourself",
                        next: 'ending',
                        effects: { timeLeft: -2, morale: -5, wellness: -5, projectCompletion: 5 }
                    },
                    {
                        text: "Share the spotlight with your team",
                        next: 'ending',
                        effects: { timeLeft: -2, morale: 20, wellness: 10, projectCompletion: 10 }
                    },
                    {
                        text: "Let your top performer take the lead",
                        next: 'ending',
                        effects: { timeLeft: -2, morale: 10, wellness: 5, projectCompletion: 5 }
                    }
                ]
            },

            ending: {
                title: "Week in Review: Your Leadership Report",
                image: "üèÜ",
                description: "The week is over. Let's see how you performed as a leader.",
                isEnding: true
            }
        };

        // Notification system
        function showNotification(message, type = 'neutral') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            notification.className = `notification show ${type}`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Game Functions
        function updateStats() {
            // Update display values
            document.getElementById('morale').textContent = Math.round(gameState.stats.morale);
            document.getElementById('time').textContent = Math.round(gameState.stats.timeLeft);
            document.getElementById('wellness').textContent = Math.round(gameState.stats.wellness);
            document.getElementById('project').textContent = Math.round(gameState.stats.projectCompletion);

            // Update progress bars
            document.getElementById('morale-bar').style.width = `${Math.min(100, Math.max(0, gameState.stats.morale))}%`;
            document.getElementById('time-bar').style.width = `${Math.min(100, Math.max(0, (gameState.stats.timeLeft / gameState.maxTime) * 100))}%`;
            document.getElementById('wellness-bar').style.width = `${Math.min(100, Math.max(0, gameState.stats.wellness))}%`;
            document.getElementById('project-bar').style.width = `${Math.min(100, Math.max(0, gameState.stats.projectCompletion))}%`;

            // Check for critical states
            if (gameState.stats.morale <= 0 || gameState.stats.wellness <= 0) {
                gameState.currentScene = 'ending';
                renderScene();
            }
        }

        function getEffectMessage(effects) {
            const messages = [];
            
            if (effects.morale > 0) messages.push("Team morale improved!");
            else if (effects.morale < -10) messages.push("Team morale took a hit!");
            
            if (effects.wellness < -10) messages.push("You're feeling the stress...");
            else if (effects.wellness > 10) messages.push("Good work-life balance!");
            
            if (effects.projectCompletion > 15) messages.push("Great progress on the project!");
            else if (effects.projectCompletion < 0) messages.push("Project progress slowed down.");
            
            if (effects.timeLeft < -5) messages.push("That took longer than expected!");
            
            return messages[0] || "Decision made.";
        }

        function getNotificationType(effects) {
            const totalEffect = effects.morale + effects.wellness + effects.projectCompletion;
            if (totalEffect > 10) return 'positive';
            if (totalEffect < -10) return 'negative';
            return 'neutral';
        }

        function applyEffects(effects) {
            const oldStats = { ...gameState.stats };
            
            gameState.stats.morale = Math.max(0, Math.min(100, gameState.stats.morale + effects.morale));
            gameState.stats.timeLeft = Math.max(0, gameState.stats.timeLeft + effects.timeLeft);
            gameState.stats.wellness = Math.max(0, Math.min(100, gameState.stats.wellness + effects.wellness));
            gameState.stats.projectCompletion = Math.max(0, Math.min(100, gameState.stats.projectCompletion + effects.projectCompletion));
            
            // Show notification about the effects
            const message = getEffectMessage(effects);
            const type = getNotificationType(effects);
            showNotification(message, type);
            
            updateStats();
        }

        function makeChoice(choiceIndex) {
            const currentSceneData = scenes[gameState.currentScene];
            const choice = currentSceneData.choices[choiceIndex];
            
            // Store decision for final review
            gameState.decisions.push({
                scene: gameState.currentScene,
                choice: choice.text,
                effects: choice.effects
            });

            // Apply effects
            applyEffects(choice.effects);

            // Move to next scene
            gameState.currentScene = choice.next;
            
            // Small delay to show stat changes before scene transition
            setTimeout(() => {
                renderScene();
            }, 500);
        }

        function calculateGrade() {
            const score = (
                gameState.stats.morale * 0.3 +
                gameState.stats.wellness * 0.2 +
                gameState.stats.projectCompletion * 0.4 +
                (gameState.stats.timeLeft > 0 ? 10 : 0)
            );

            if (score >= 90) return 'A+';
            if (score >= 80) return 'A';
            if (score >= 70) return 'B+';
            if (score >= 60) return 'B';
            if (score >= 50) return 'C';
            return 'D';
        }

        function generateFeedback() {
            const strengths = [];
            const improvements = [];

            // Analyze final stats
            if (gameState.stats.morale >= 70) {
                strengths.push("Excellent team morale management - Your team trusts your leadership");
            } else if (gameState.stats.morale >= 40) {
                improvements.push("Team morale needs attention - Consider more inclusive decision-making");
            } else {
                improvements.push("Critical: Team morale is dangerously low - Prioritize team well-being");
            }

            if (gameState.stats.wellness >= 60) {
                strengths.push("Good work-life balance - You set healthy boundaries");
            } else if (gameState.stats.wellness >= 30) {
                improvements.push("Work-life balance needs improvement - Remember to delegate more");
            } else {
                improvements.push("Critical: Burnout risk - You can't lead effectively if you're exhausted");
            }

            if (gameState.stats.projectCompletion >= 80) {
                strengths.push("Outstanding project delivery - Goals were exceeded");
            } else if (gameState.stats.projectCompletion >= 60) {
                strengths.push("Solid project completion - Key objectives were met");
            } else if (gameState.stats.projectCompletion >= 40) {
                improvements.push("Project completion needs work - Focus on prioritization");
            } else {
                improvements.push("Critical: Project goals were not met - Review time management strategies");
            }

            if (gameState.stats.timeLeft > 10) {
                strengths.push("Excellent time management - You worked efficiently");
            } else if (gameState.stats.timeLeft <= 0) {
                improvements.push("Time management needs improvement - You overcommitted resources");
            }

            // Analyze decision patterns
            const overtimeDecisions = gameState.decisions.filter(d => d.choice.toLowerCase().includes('overtime'));
            if (overtimeDecisions.length > 0) {
                improvements.push("Consider alternatives to overtime - It's not always the answer");
            }

            const delegationDecisions = gameState.decisions.filter(d => d.choice.toLowerCase().includes('delegate'));
            if (delegationDecisions.length >= 2) {
                strengths.push("Good delegation skills - You trust your team");
            }

            return { strengths, improvements };
        }

        function renderEnding() {
            const grade = calculateGrade();
            const feedback = generateFeedback();
            
            let gradeEmoji = 'üèÜ';
            if (grade.includes('A')) gradeEmoji = 'üåü';
            else if (grade.includes('B')) gradeEmoji = 'üëç';
            else if (grade.includes('C')) gradeEmoji = 'üìà';
            else gradeEmoji = 'üí™';

            const endingHTML = `
                <div class="scene-image">${gradeEmoji}</div>
                <h2 class="scene-title">Final Performance Review</h2>
                
                <div class="ending-summary">
                    <div class="ending-grade">Grade: ${grade}</div>
                    
                    <div class="feedback-section">
                        <h3 class="feedback-title">
                            <span>‚ú®</span>
                            <span>Your Strengths</span>
                        </h3>
                        <ul class="feedback-list">
                            ${feedback.strengths.map(s => `<li>${s}</li>`).join('')}
                            ${feedback.strengths.length === 0 ? '<li>Keep working on building your leadership skills</li>' : ''}
                        </ul>
                    </div>
                    
                    <div class="feedback-section">
                        <h3 class="feedback-title">
                            <span>üìö</span>
                            <span>Areas for Growth</span>
                        </h3>
                        <ul class="feedback-list improvements">
                            ${feedback.improvements.map(i => `<li>${i}</li>`).join('')}
                            ${feedback.improvements.length === 0 ? '<li>Outstanding performance! Keep maintaining this balance</li>' : ''}
                        </ul>
                    </div>
                    
                    <div class="feedback-section">
                        <h3 class="feedback-title">
                            <span>üìä</span>
                            <span>Final Statistics</span>
                        </h3>
                        <ul class="feedback-list">
                            <li>Team Morale: ${Math.round(gameState.stats.morale)}%</li>
                            <li>Personal Wellness: ${Math.round(gameState.stats.wellness)}%</li>
                            <li>Project Completion: ${Math.round(gameState.stats.projectCompletion)}%</li>
                            <li>Time Efficiency: ${gameState.stats.timeLeft > 0 ? `${gameState.stats.timeLeft} hours saved` : 'All time utilized'}</li>
                        </ul>
                    </div>
                </div>
                
                <button class="restart-btn" onclick="restartGame()">Play Again</button>
            `;
            
            document.getElementById('scene-container').innerHTML = endingHTML;
        }

        function renderScene() {
            const sceneData = scenes[gameState.currentScene];
            
            if (sceneData.isEnding) {
                renderEnding();
                return;
            }

            let sceneHTML = `
                <div class="scene-image">${sceneData.image}</div>
                <h2 class="scene-title">${sceneData.title}</h2>
                <p class="scene-description">${sceneData.description}</p>
            `;

            if (sceneData.dialogue) {
                const character = gameState.characters[sceneData.dialogue.character];
                sceneHTML += `
                    <div class="character-dialogue">
                        <div class="character-name">${character.emoji} ${character.name}:</div>
                        <div>${sceneData.dialogue.text}</div>
                    </div>
                `;
            }

            sceneHTML += '<div class="choices-container">';
            sceneData.choices.forEach((choice, index) => {
                sceneHTML += `
                    <button class="choice-btn" onclick="makeChoice(${index})">
                        <div>${choice.text}</div>
                    </button>
                `;
            });
            sceneHTML += '</div>';

            document.getElementById('scene-container').innerHTML = sceneHTML;
        }

        function restartGame() {
            // Reset game state
            gameState.currentScene = 'intro';
            gameState.stats = {
                morale: 75,
                timeLeft: 40,
                wellness: 70,
                projectCompletion: 0
            };
            gameState.decisions = [];
            
            updateStats();
            renderScene();
        }

        // Initialize game
        document.addEventListener('DOMContentLoaded', () => {
            updateStats();
            renderScene();
        });
    </script>
</body>
</html>
